<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>æŠ½çæ´»å‹•</title>

    <!-- Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- jQuery / jQuery UI (for sortable) -->
    <link
      rel="stylesheet"
      href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css"
    />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

    <style>
      #wheel {
        border: 2px solid #ccc;
        border-radius: 50%;
        background: #fff;
      }
      .card {
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
      }
      .list-group-item {
        cursor: grab;
      }
      /* åƒèˆ‡åå–®ä¸‰è¡Œæ”¶æŠ˜ */
      #wheelNames {
        white-space: normal;
        word-break: break-word;
      }
      .clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div class="container mt-3">
      <!-- æ´»å‹•åç¨±å€ -->
      <div class="row mb-3">
        <div class="col-12 d-flex align-items-center">
          <!-- æ”¾åŒå±¤çš„åœ–ç‰‡æª”å -->
          <img
            src="gce.png"
            alt="æ´»å‹•Logo"
            style="height: 40px; margin-right: 10px"
          />
          <h2 class="mb-0">é½Šå¿ƒå”åŠ› ç›Šèµ·å¥èµ°</h2>
          <div class="ms-auto d-flex align-items-center gap-3">
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="soundSwitch"
                checked
              />
              <label class="form-check-label" for="soundSwitch">éŸ³æ•ˆ</label>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <!-- å·¦å´ï¼šåå–®èˆ‡çé … -->
        <div class="col-md-5">
          <div class="card mb-3">
            <div
              class="card-header d-flex align-items-center justify-content-between"
            >
              <span>åå–®è¼¸å…¥å€</span>
              <div class="btn-group btn-group-sm">
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  id="exportNamesCsvBtn"
                >
                  åŒ¯å‡ºåå–® CSV
                </button>
                <button
                  type="button"
                  class="btn btn-outline-primary"
                  id="importNamesCsvBtn"
                >
                  åŒ¯å…¥åå–® CSV
                </button>
                <input
                  type="file"
                  id="importNamesCsvInput"
                  accept=".csv"
                  hidden
                />
              </div>
            </div>
            <div class="card-body">
              <textarea
                id="participants"
                class="form-control mb-2"
                rows="8"
                placeholder="æ¯è¡Œä¸€å€‹åé¡"
              ></textarea>
              <div class="mb-2">
                <button
                  type="button"
                  class="btn btn-primary btn-sm"
                  id="importBtn"
                >
                  åŒ¯å…¥åå–®ï¼ˆæ–‡å­—æ¡†ï¼‰
                </button>
                <button
                  type="button"
                  class="btn btn-secondary btn-sm"
                  id="clearBtn"
                >
                  æ¸…é™¤
                </button>
              </div>
              <div>ç›®å‰åå–®æ•¸ï¼š<span id="count">0</span></div>
            </div>
          </div>

          <div class="card mb-3">
            <div
              class="card-header d-flex align-items-center justify-content-between"
            >
              <span>çé …è³‡æ–™è¼¸å…¥å€</span>
              <div class="btn-group btn-group-sm">
                <button
                  type="button"
                  class="btn btn-outline-secondary"
                  id="exportPrizesCsvBtn"
                >
                  åŒ¯å‡ºçé … CSV
                </button>
                <button
                  type="button"
                  class="btn btn-outline-primary"
                  id="importPrizesCsvBtn"
                >
                  åŒ¯å…¥çé … CSV
                </button>
                <input
                  type="file"
                  id="importPrizesCsvInput"
                  accept=".csv"
                  hidden
                />
              </div>
            </div>
            <div class="card-body">
              <div class="input-group mb-2">
                <input
                  type="text"
                  id="prizeName"
                  class="form-control"
                  placeholder="çé …åç¨±"
                />
                <input
                  type="number"
                  id="prizeCount"
                  class="form-control"
                  value="1"
                  min="1"
                  style="max-width: 90px"
                />
                <button type="button" class="btn btn-success" id="addPrize">
                  æ–°å¢
                </button>
              </div>
              <div id="prizeList" class="list-group"></div>
            </div>
          </div>
        </div>

        <!-- å³å´ï¼šè½‰ç›¤èˆ‡ç´€éŒ„ -->
        <div class="col-md-7">
          <div class="card mb-3">
            <div class="card-header">æŠ½çè½‰ç›¤å€</div>
            <div class="card-body text-center">
              <div id="currentPrize" class="mb-2 fw-bold"></div>
              <canvas
                id="wheel"
                width="300"
                height="300"
                style="margin-bottom: 10px"
              ></canvas>
              <div>
                <button class="btn btn-warning" id="drawBtn">æŠ½ç</button>
              </div>

              <!-- åƒèˆ‡åå–®ï¼ˆå¯æ”¶æŠ˜ï¼‰ -->
              <div class="mt-3 text-start">
                <div class="mb-1 fw-semibold">åƒèˆ‡åå–®ï¼š</div>
                <div id="wheelNames" class="clamp-3"></div>
                <button id="toggleNames" class="btn btn-link btn-sm p-0 mt-1">
                  å±•é–‹å…¨éƒ¨
                </button>
              </div>
            </div>
          </div>

          <div class="card">
            <div
              class="card-header d-flex align-items-center justify-content-between"
            >
              <span>æŠ½çç´€éŒ„</span>
              <button
                type="button"
                class="btn btn-outline-secondary btn-sm"
                id="exportWinnersCsvBtn"
              >
                åŒ¯å‡ºä¸­çåå–® CSV
              </button>
            </div>
            <div class="card-body">
              <ul id="winnerList" class="list-group"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ä¸­çå½ˆè·³è¦–çª— -->
    <div
      class="modal fade"
      id="winnerModal"
      tabindex="-1"
      aria-labelledby="winnerModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="winnerModalLabel">ğŸ‰ æ­å–œä¸­çï¼</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="é—œé–‰"
            ></button>
          </div>
          <div class="modal-body text-center">
            <div
              id="modalPrize"
              style="font-size: 1.2em; font-weight: bold"
            ></div>
            <div
              id="modalWinner"
              style="font-size: 2em; color: #d9534f; margin: 10px 0"
            ></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-primary"
              id="nextDrawBtn"
              data-bs-dismiss="modal"
            >
              æº–å‚™ä¸‹ä¸€æŠ½
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      // ===== ç‹€æ…‹ =====
      let participants = [];
      let prizes = [];
      let winners = [];
      let currentPrizeIdx = 0;
      let isDrawing = false;
      let enableSound = true;

      // ===== éŸ³æ•ˆï¼ˆWeb Audio ç”¢ç”Ÿï¼šè½‰ç›¤æ»´ç­” & ä¸­çå°è™Ÿï¼‰ =====
      let audioCtx = null;
      function ensureAudio() {
        if (!audioCtx)
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      function playTick() {
        if (!enableSound) return;
        ensureAudio();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = "square";
        o.frequency.value = 900;
        g.gain.value = 0.03;
        o.connect(g).connect(audioCtx.destination);
        o.start();
        setTimeout(() => {
          o.stop();
        }, 40);
      }
      function playWin() {
        if (!enableSound) return;
        ensureAudio();
        const now = audioCtx.currentTime;
        const freqs = [523.25, 659.25, 783.99, 1046.5]; // C-E-G-C
        freqs.forEach((f, i) => {
          const o = audioCtx.createOscillator();
          const g = audioCtx.createGain();
          o.type = "sine";
          o.frequency.setValueAtTime(f, now + i * 0.12);
          g.gain.setValueAtTime(0.0001, now + i * 0.12);
          g.gain.exponentialRampToValueAtTime(0.2, now + i * 0.12 + 0.02);
          g.gain.exponentialRampToValueAtTime(0.0001, now + i * 0.12 + 0.25);
          o.connect(g).connect(audioCtx.destination);
          o.start(now + i * 0.12);
          o.stop(now + i * 0.12 + 0.28);
        });
      }
      $("#soundSwitch").on("change", function () {
        enableSound = this.checked;
      });

      // ===== ç…™ç«ï¼ˆconfettiï¼‰ =====
      function fireConfetti() {
        const end = Date.now() + 800;
        (function frame() {
          confetti({ particleCount: 20, spread: 70, origin: { y: 0.6 } });
          if (Date.now() < end) requestAnimationFrame(frame);
        })();
      }

      // ===== åå–®è™•ç† =====
      function updateParticipants() {
        participants = $("#participants")
          .val()
          .split("\n")
          .map((x) => x.trim())
          .filter((x) => x !== "");
        $("#count").text(participants.length);
        updateWheel();
        updateNamesArea();
      }
      $("#participants").on("input", updateParticipants);
      $("#importBtn").on("click", updateParticipants);
      $("#clearBtn").on("click", () => {
        $("#participants").val("");
        updateParticipants();
      });

      // ===== CSV åŒ¯å…¥/åŒ¯å‡ºï¼šåå–® =====
      $("#importNamesCsvBtn").on("click", () =>
        $("#importNamesCsvInput").click()
      );
      $("#importNamesCsvInput").on("change", function () {
        const file = this.files[0];
        if (!file) return;
        file.text().then((text) => {
          const rows = parseCSV(text);
          if (rows.length === 0) {
            return Swal.fire("åŒ¯å…¥å¤±æ•—", "æª”æ¡ˆå…§å®¹ç‚ºç©º", "error");
          }
          let header = rows[0].map((x) => x.toLowerCase());
          let hasHeader = header.includes("name") || header.includes("å§“å");
          let start = hasHeader ? 1 : 0;
          let names = [];
          for (let i = start; i < rows.length; i++) {
            const row = rows[i];
            const val = (row[0] || "").trim();
            if (val) names.push(val);
          }
          if (names.length === 0)
            return Swal.fire("åŒ¯å…¥å¤±æ•—", "æ‰¾ä¸åˆ°ä»»ä½•åå­—", "error");
          $("#participants").val(names.join("\n"));
          updateParticipants();
          this.value = "";
          Swal.fire("åŒ¯å…¥å®Œæˆ", `å…± ${names.length} ç­†åå–®`, "success");
        });
      });
      $("#exportNamesCsvBtn").on("click", function () {
        const csv = toCSV([["name"], ...participants.map((n) => [n])]);
        downloadCsv(csv, "participants.csv");
      });

      // ===== CSV åŒ¯å…¥/åŒ¯å‡ºï¼šçé … =====
      $("#importPrizesCsvBtn").on("click", () =>
        $("#importPrizesCsvInput").click()
      );
      $("#importPrizesCsvInput").on("change", function () {
        const file = this.files[0];
        if (!file) return;
        file.text().then((text) => {
          const rows = parseCSV(text);
          if (rows.length === 0) {
            return Swal.fire("åŒ¯å…¥å¤±æ•—", "æª”æ¡ˆå…§å®¹ç‚ºç©º", "error");
          }
          let header = rows[0].map((x) => x.toLowerCase());
          let hasHeader =
            header.includes("name") ||
            header.includes("çé …") ||
            header.includes("prize");
          let start = hasHeader ? 1 : 0;
          const list = [];
          for (let i = start; i < rows.length; i++) {
            const r = rows[i];
            const name = (r[0] || "").trim();
            const count = parseInt((r[1] || "1").trim(), 10);
            if (name && Number.isFinite(count) && count > 0)
              list.push({ name, count });
          }
          if (list.length === 0)
            return Swal.fire(
              "åŒ¯å…¥å¤±æ•—",
              "ç„¡æœ‰æ•ˆçé …è³‡æ–™ï¼ˆéœ€å…©æ¬„ï¼šname,countï¼‰",
              "error"
            );
          prizes = list;
          renderPrizes();
          updateCurrentPrize();
          this.value = "";
          Swal.fire("åŒ¯å…¥å®Œæˆ", `å…± ${list.length} å€‹çé …`, "success");
        });
      });
      $("#exportPrizesCsvBtn").on("click", function () {
        const rows = [
          ["name", "count"],
          ...prizes.map((p) => [p.name, String(p.count)]),
        ];
        downloadCsv(toCSV(rows), "prizes.csv");
      });

      // ===== åŒ¯å‡ºä¸­çåå–® =====
      $("#exportWinnersCsvBtn").on("click", function () {
        const rows = [
          ["order", "prize", "name", "time"],
          ...winners.map((w) => [w.order, w.prize, w.name, w.time]),
        ];
        downloadCsv(toCSV(rows), "winners.csv");
      });

      // ===== CSV å·¥å…· =====
      function downloadCsv(csv, filename) {
        const blob = new Blob(["\ufeff" + csv], {
          type: "text/csv;charset=utf-8;",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = filename;
        a.click();
        URL.revokeObjectURL(url);
      }
      function toCSV(rows) {
        return rows
          .map((r) =>
            r
              .map((cell) => {
                const s = String(cell ?? "");
                if (/[",\n]/.test(s)) return `"${s.replace(/"/g, '""')}"`;
                return s;
              })
              .join(",")
          )
          .join("\n");
      }
      // ç°¡å–® CSV è§£æï¼ˆæ”¯æ´å¼•è™Ÿã€é€—è™Ÿã€æ›è¡Œï¼‰
      function parseCSV(text) {
        const rows = [];
        let row = [];
        let i = 0;
        let cur = "";
        let inQ = false;
        // å»é™¤ BOM
        if (text.charCodeAt(0) === 0xfeff) text = text.slice(1);
        while (i < text.length) {
          const ch = text[i];
          if (inQ) {
            if (ch === '"') {
              if (text[i + 1] === '"') {
                cur += '"';
                i += 2;
                continue;
              }
              inQ = false;
              i++;
              continue;
            } else {
              cur += ch;
              i++;
              continue;
            }
          } else {
            if (ch === '"') {
              inQ = true;
              i++;
              continue;
            }
            if (ch === ",") {
              row.push(cur);
              cur = "";
              i++;
              continue;
            }
            if (ch === "\n") {
              row.push(cur);
              rows.push(row);
              row = [];
              cur = "";
              i++;
              continue;
            }
            if (ch === "\r") {
              i++;
              continue;
            }
            cur += ch;
            i++;
          }
        }
        row.push(cur);
        rows.push(row);
        // å»æ‰å¯èƒ½çš„ç©ºç™½è¡Œ
        return rows.filter((r) => !(r.length === 1 && r[0].trim() === ""));
      }

      // ===== çé …æ–°å¢ / æ’åº / åˆªé™¤ =====
      $("#addPrize").on("click", function () {
        const name = $("#prizeName").val().trim();
        const count = parseInt($("#prizeCount").val(), 10);
        if (!name || !Number.isFinite(count) || count <= 0) {
          return Swal.fire(
            "è³‡æ–™ä¸å®Œæ•´",
            "è«‹è¼¸å…¥æœ‰æ•ˆçš„çé …åç¨±èˆ‡æ•¸é‡",
            "warning"
          );
        }
        prizes.push({ name, count });
        $("#prizeName").val("");
        $("#prizeCount").val(1);
        renderPrizes();
        updateCurrentPrize();
      });

      function renderPrizes() {
        const $list = $("#prizeList").empty();
        prizes.forEach((p, i) => {
          $list.append(
            `<div class="list-group-item d-flex justify-content-between align-items-center" data-idx="${i}">
           <span>${i + 1}. ${p.name} <span class="badge bg-secondary">${
              p.count
            }</span></span>
           <button type="button" class="btn btn-danger btn-sm removePrize">åˆªé™¤</button>
         </div>`
          );
        });
        // sortable
        $("#prizeList").sortable({
          update: function () {
            const old = prizes.slice();
            const newOrderIdx = $(this)
              .children()
              .map(function () {
                return $(this).data("idx");
              })
              .get();
            prizes = newOrderIdx.map((idx) => old[idx]);
            renderPrizes();
            updateCurrentPrize();
          },
        });
      }
      $("#prizeList").on("click", ".removePrize", function () {
        const idx = $(this).closest(".list-group-item").data("idx");
        prizes.splice(idx, 1);
        renderPrizes();
        updateCurrentPrize();
      });

      // ===== è½‰ç›¤ =====
      function updateWheel() {
        const canvas = document.getElementById("wheel");
        if (!canvas) return;
        const ctx = canvas.getContext("2d");
        const names = participants;
        const len = names.length;
        ctx.clearRect(0, 0, 300, 300);
        if (!len) return;
        const angle = (2 * Math.PI) / len;
        for (let i = 0; i < len; i++) {
          ctx.beginPath();
          ctx.moveTo(150, 150);
          ctx.arc(150, 150, 140, i * angle, (i + 1) * angle);
          ctx.closePath();
          ctx.fillStyle = `hsl(${(i * 360) / len},70%,70%)`;
          ctx.fill();
          ctx.save();
          ctx.translate(150, 150);
          ctx.rotate((i + 0.5) * angle);
          ctx.textAlign = "right";
          ctx.font = "16px Arial";
          ctx.fillStyle = "#333";
          ctx.fillText(names[i], 130, 8);
          ctx.restore();
        }
        // æŒ‡é‡
        ctx.beginPath();
        ctx.moveTo(150, 10);
        ctx.lineTo(140, 30);
        ctx.lineTo(160, 30);
        ctx.closePath();
        ctx.fillStyle = "#d9534f";
        ctx.fill();
      }

      function highlightWheel(idx) {
        updateWheel();
        const canvas = document.getElementById("wheel");
        if (!canvas) return;
        const ctx = canvas.getContext("2d");
        const len = participants.length;
        if (!len) return;
        const angle = (2 * Math.PI) / len;
        ctx.save();
        ctx.beginPath();
        ctx.moveTo(150, 150);
        ctx.arc(150, 150, 140, idx * angle, (idx + 1) * angle);
        ctx.closePath();
        ctx.fillStyle = "rgba(255,215,0,.5)";
        ctx.fill();
        ctx.restore();
      }

      // ===== åƒèˆ‡åå–®é¡¯ç¤ºï¼ˆ3 è¡Œæ”¶æŠ˜ï¼‰ =====
      function updateNamesArea() {
        $("#wheelNames").text(participants.join(", "));
        clampNames(true);
        // åˆ¤æ–·æ˜¯å¦éœ€è¦é¡¯ç¤ºæŒ‰éˆ•ï¼ˆå…§å®¹é«˜åº¦è¶…é 3 è¡Œï¼‰
        const el = document.getElementById("wheelNames");
        const needBtn = el.scrollHeight > el.clientHeight + 1;
        $("#toggleNames").toggle(needBtn);
      }
      function clampNames(shouldClamp) {
        const $names = $("#wheelNames");
        if (shouldClamp) {
          $names.addClass("clamp-3");
          $("#toggleNames").text("å±•é–‹å…¨éƒ¨");
        } else {
          $names.removeClass("clamp-3");
          $("#toggleNames").text("æ”¶åˆ");
        }
        $("#toggleNames").data("expanded", !shouldClamp);
      }
      $("#toggleNames").on("click", function () {
        const expanded = $(this).data("expanded") === true;
        clampNames(expanded); // å¦‚æœå·²å±•é–‹ -> æ”¶åˆï¼›è‹¥æ”¶åˆ -> å±•é–‹
      });

      // ===== é¡¯ç¤ºç›®å‰çé … =====
      function updateCurrentPrize() {
        if (prizes.length > 0 && currentPrizeIdx < prizes.length) {
          $("#currentPrize").text("ç•¶å‰çé …ï¼š" + prizes[currentPrizeIdx].name);
        } else {
          $("#currentPrize").text("æ‰€æœ‰çé …å·²æŠ½å®Œ");
        }
      }

      // ===== æŠ½ç =====
      const winnerModalEl = document.getElementById("winnerModal");
      const bsWinnerModal = new bootstrap.Modal(winnerModalEl);

      $("#drawBtn").on("click", function () {
        if (isDrawing) return;

        if (currentPrizeIdx >= prizes.length) {
          return Swal.fire(
            "æ‰€æœ‰çé …å·²æŠ½å®Œ",
            "è«‹æ–°å¢çé …æˆ–é‡æ–°æ•´ç†é é¢",
            "info"
          );
        }
        if (participants.length === 0 || prizes.length === 0) {
          return Swal.fire("è³‡æ–™ä¸è¶³", "è«‹ç¢ºèªåå–®èˆ‡çé …çš†å·²è¨­å®š", "warning");
        }
        if (prizes[currentPrizeIdx].count <= 0) {
          currentPrizeIdx++;
          updateCurrentPrize();
          if (currentPrizeIdx >= prizes.length) {
            return Swal.fire(
              "æ‰€æœ‰çé …å·²æŠ½å®Œ",
              "è«‹æ–°å¢çé …æˆ–é‡æ–°æ•´ç†é é¢",
              "info"
            );
          }
          return;
        }

        isDrawing = true;
        const winnerIdx = Math.floor(Math.random() * participants.length);
        const rounds = 20 + Math.floor(Math.random() * 10);
        let step = 0;
        const timer = setInterval(() => {
          const idx = (winnerIdx + step) % participants.length;
          highlightWheel(idx);
          playTick();
          step++;
          if (step > rounds) {
            clearInterval(timer);
            setTimeout(() => showWinner(winnerIdx), 500);
          }
        }, 80);
      });

      function showWinner(winnerIdx) {
        const winner = participants[winnerIdx];
        const prizeName = prizes[currentPrizeIdx].name;

        // å½ˆçª—
        $("#modalPrize").text("çé …ï¼š" + prizeName);
        $("#modalWinner").text(winner);
        bsWinnerModal.show();

        playWin();
        fireConfetti();

        // ç´€éŒ„ï¼ˆæœ€æ–°åœ¨æœ€ä¸Šé¢ï¼‰
        const now = new Date();
        winners.unshift({
          order: winners.length + 1,
          prize: prizeName,
          name: winner,
          time: now.toLocaleString(),
        });
        $("#winnerList").prepend(
          `<li class="list-group-item">${winners[0].order}. ${winners[0].prize} - ${winners[0].name}
        <span class="text-muted float-end">${winners[0].time}</span></li>`
        );

        // **ä¸€æ¬¡ç§»é™¤åå–®ä¸­æ‰€æœ‰é‡è¤‡çš„ä¸­çè€…**
        participants = participants.filter((n) => n !== winner);
        $("#participants").val(participants.join("\n"));

        // æ‰£çæ•¸ / åˆ‡ä¸‹å€‹çé …
        prizes[currentPrizeIdx].count--;
        if (prizes[currentPrizeIdx].count <= 0) {
          currentPrizeIdx++;
        }

        updateParticipants(); // æœƒé †ä¾¿é‡ç•«è½‰ç›¤ & åå–®å€
        renderPrizes();
        updateCurrentPrize();
        isDrawing = false;
      }

      $("#nextDrawBtn").on("click", function () {
        if (currentPrizeIdx >= prizes.length) {
          Swal.fire("æ‰€æœ‰çé …å·²æŠ½å®Œ", "æ­å–œå®Œæˆæ‰€æœ‰æŠ½çï¼", "success");
        }
      });

      // åˆå§‹
      $(function () {
        updateParticipants();
        renderPrizes();
        updateCurrentPrize();
        clampNames(true);
        $("#toggleNames").hide(); // åˆå§‹å…ˆéš±è—ï¼Œå…§å®¹é•·åº¦å†æ±ºå®šæ˜¯å¦é¡¯ç¤º
      });
    </script>
  </body>
</html>
